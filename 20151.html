<!DOCTYPE html>
<html>
<head>  
	<meta charset="utf-8">
     	<title>Simple icon array example</title>
	<script src="http://d3js.org/d3.v4.0.0-alpha.18.min.js" charset="utf-8"></script>
	<script type="text/javascript" src="20151.js"></script>
	<style>
	*{
		font-family: sans-serif;
	}
	p.bar-label{
	margin:0px;
	}
	{g.Anti-Black or African American}{
		fill:#9028DA;
	}
	g.Anti-Multiple Races{
		fill:#F00;
	}
	g.Anti-Hispanic{
		:#EA0;
	}
	g.Anti-White{
		fill:#DD0;
	}
	g.Anti-Asian{
		fill:#AAA;
	}

	

	p{
		max-width: 600px;
	}
	</style>
</head>
<body>
<p>By default the icon array is built width first. Whilst this has some nice properties like using the full width available, leading to a percieved compactness, it doesn't allow easy comparison between arrays. In this case the Conservative and Labour arrays look about the same ... </p>
<div id="width-first">
	
</div>
<p>A height first construction allows a better approximation of a bar chart (comparisons of length are much easier than comparisons of area so we want to emphasise those differences) and the difference between the front runners becomes more apparent.</p>
<div id="height-first">
	
</div>
<p>Note the smaller values become a little tricker to compare but that the ease of countability (is that a word?) which a icon array provides can help here providing more legible information than an equivalent bar chart would at a similar scale.

</body>


<script type="text/javascript">
	
var results = [
  {
   label:"Anti-Gay (Male)",
   count:"405.6692536"
 },
 {
   label:"Anti-Jewish",
   count:"272.761194"
 },
 {
   label:"Anti-Islamic (Muslim)",
   count:"227.5759822"
 },
 {
   label:"Anti-Lesbian",
   count:"98.70212511"
 },
 {
   label: "Anti-Other Christian",
   count: "87.37864078"
 },
 {
   label: "Anti-Sikh",
   count: "76.92307692"
 },
 {
   label: "Anti-Eastern Orthodox (Russian, Greek, Other)",
   count: "60.67961165"
 },
 {
   label:"Anti-Black or African American",
   count:"55.15171797"
 },
 {
   label:"Anti-American Indian or Alaska Native",
   count:"54.88153762"
 },
 {
   label:"Anti-Transgender",
   count:"54.28571429"
 },
 {
   label:"Anti-Other Religion",
   count:"36.65638917"
 },
 {
   label:"Anti-Arab",
   count:"31.62755392"
 },
 {
   label:"Anti-Other Race/Ethnicity/Ancestry",
   count:"23.07393521"
 },
 {
   label:"Anti-Multiple Races",
   count:"16.93501073"
 },
 {
   label:"Anti-Native Hawaiian or Other Pacific Islander",
   count:"10.98388115"
 },
 {
   label:"Anti-Lesbian, Gay, Bisexual, or Transgender (Mixed Group)",
   count:"10.82200125"
 },
 {
   label:"Anti-Hindu",
   count:"8.591065292"
 },
 {
   label:"Anti-Asian",
   count:"8.376805979"
 },
 {
   label:"Anti-Hispanic or Latino",
   count:"7.228177427"
 },
 {
   label:"Anti-White",
   count:"3.387093897"
 },
 {
   label:"Anti-Mormon",
   count:"2.533248892"
 },
 {
   label:"Anti-Bisexual",
   count:"2.191233314"
 },
 {
   label:"Anti-Catholic",
   count:"1.048969388"
 },
 {
   label:"Anti-Buddhist",
   count:"0.841042893"
 },
 {
   label:"Anti-Atheism/Agnosticism/etc.",
   count:"0.55463117"
 }, {
   label:"Anti-Jehovah's Witness",
   count:"0.52246604"
 },
 {
   label:"Anti-Protestant",
   count:"0.369789094"
 },
 {
   label:"Anti-Female",
   count:"0.191598228"
 },
 {
   label:"Multiple-Bias Incidents",
   count:"0.164289201"
 },
 {
   label:"Anti-Heterosexual",
   count:"0.108881158"
 },
 {
   label:"Anti-Male",
   count:"0.074321055"
 },
 {
   label:"Anti-Multiple Religions, Group",
   count:"#DIV/0!"
 },
 {
   label: "Anti-Physical",
   count: "#DIV/0!"
 },
 {
   label: "Anti-Mental",
   count: "#DIV/0!"
 },
 {
   label: "Anti-Gender Non-Conforming",
   count: "#DIV/0!"
 }
];

var gridWidth = 70;
var gridHeight = 12;
var layout = d3_iconarray.layout()
	.width(gridWidth)
	.height(gridHeight);
var width = 800;
var height = 200;
var radius = 5;
var margin = { top:radius*2, left:radius*2, bottom:radius*2, right:radius*2 }
var scale = d3.scaleLinear()
				.range([0, (width-(margin.left + margin.right))])
				.domain([0, gridWidth]);


console.log(scale.range())

d3.select('#width-first')
	.selectAll('div.result')
		.data(results)
	.enter()
		.append('div').attr('class','result')
			.call(arrayBars, true);

d3.select('#height-first')
	.selectAll('div.result')
		.data(results)
	.enter()
		.append('div').attr('class','result')
			.call(arrayBars, false);

function arrayBars(parent, widthFirst){
		layout.widthFirst(widthFirst);

		parent.append('p')
			.attr('class','bar-label')
			.html(function(d){ 
				return d.label; 
			});

		parent.append('svg')
			.attr('width', width).attr('height', height)
		.append('g')
			.attr('transform','translate('+margin.left+','+margin.top+')')
			.attr('class',function(d){return d.label})
		.selectAll('circle')
			.data(function(d){ return layout( d3.range(0, d.count, 1) ); })
		.enter()
			.append('circle')
				.attr('cx',function(d){ return scale(d.position.x); })
				.attr('cy',function(d){ return scale(d.position.y); })
				.attr('r', radius)
}

</script>
</html>